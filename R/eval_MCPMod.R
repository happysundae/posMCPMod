#' Generate evaluation matrix for simulation results.
#'
#' This function will create key results summary including PoC (Proof-of-Concept), MED (Minimum Effective Dose), POS (Probability of Successfully Identifying MED), and etc.
#' @details Author: Qing Zhao
#' @param res.obj A data frame generated by `analy_MCPMod` that contains the PoC and MED.
#' @param true.med A numeric value indicating the assumed true MED based on the assumed true dose response relationship and the clinically meaningful effect size. 
#' @param lower A numeric value indicating the lower limit of the range that is reasonable for the estimated MED to fall relative to the assumed true MED.
#' @param upper A numeric value indicating the upper limit of the range that is reasonable for the estimated MED to fall relative to the assumed true MED.
#' @return A list of key variables that contains the PoC, MED, POS, under (probability of underestimating the MED beyond the lower bound), and over (probability of overestimating the MED beyond the upper bound).
#' @export
#'
#' @examples
#' \dontrun{
#' pos.mat <- unlist(eval_MCPMod(res.obj, true.med, lower = 0.8, upper = 1.2))
#'}

eval_MCPMod <- function(res.obj, true.med, lower, upper){
  
  poc <- ifelse(res.obj$poc == 0, 0, 1)
  pos <- ifelse(res.obj$med < lower*true.med | res.obj$med > upper*true.med | is.na(res.obj$med) == T | res.obj$poc == 0, 0, 1)
  under <- ifelse(res.obj$med >= lower*true.med | is.na(res.obj$med) == T | res.obj$poc == 0, 0, 1)
  over <- ifelse(res.obj$med <= upper*true.med | is.na(res.obj$med) == T | res.obj$poc == 0, 0, 1)
  return(list(poc = poc, est.med = res.obj$med, true.med = true.med, pos = pos, under = under, over = over))
  
}